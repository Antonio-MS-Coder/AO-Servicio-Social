"use strict";(self.webpackChunkdoom_mvp=self.webpackChunkdoom_mvp||[]).push([[169],{5169:(e,a,r)=>{r.r(a),r.d(a,{default:()=>O});var t=r(2555),o=r(5043),s=r(9981),n=r(9252),i=r(6446),l=r(3336),c=r(5865),d=r(6839),p=r(5078),m=r(2299),h=r(7254),x=r(3193),u=r(8492),A=r(4605),j=r(6374),g=r(3495),b=r(1787),y=r(7392),f=r(1962),v=r(1673),w=r(1637),N=r(1906),C=r(9336),T=r(7332),k=r(4770),W=r(9506),E=r(8262),S=r(1991),D=r(9893),I=r(9974),B=r(3632),P=r(3559),R=r(9066),z=r(8836),M=r(823),L=r(6667),_=r(579);const O=()=>{const e=(0,s.Zp)(),{register:a}=(0,R.A)(),[r,O]=(0,o.useState)(0),q=["M\xe9todo de registro","Tipo de cuenta","Informaci\xf3n personal","Verificaci\xf3n"],[H,U]=(0,o.useState)(0),[F,G]=(0,o.useState)({fullName:"",email:"",phone:"",password:"",confirmPassword:"",role:"worker",trade:"",experience:0,companyName:"",businessType:"",location:"\xc1lvaro Obreg\xf3n",acceptTerms:!1}),[V,J]=(0,o.useState)(""),[Q,Y]=(0,o.useState)(null),[Z,$]=(0,o.useState)(null),[K,X]=(0,o.useState)(!1),[ee,ae]=(0,o.useState)(""),[re,te]=(0,o.useState)(!1),[oe,se]=(0,o.useState)({});(0,o.useEffect)(()=>{if(!Z&&1===H){const e=(0,z.zE)("register-recaptcha-container");$(e)}},[Z,H]);const ne=(e,a)=>{switch(e){case"fullName":return a.length<3?"El nombre debe tener al menos 3 caracteres":"";case"email":return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a)?"":"Email inv\xe1lido";case"phone":return a.length<10?"El tel\xe9fono debe tener 10 d\xedgitos":"";case"password":return a.length<6?"La contrase\xf1a debe tener al menos 6 caracteres":"";case"confirmPassword":return a!==F.password?"Las contrase\xf1as no coinciden":"";case"companyName":return"employer"===F.role&&a.length<2?"El nombre de la empresa es requerido":"";case"trade":return"worker"!==F.role||a?"":"Selecciona tu oficio principal";case"acceptTerms":return a?"":"Debes aceptar los t\xe9rminos y condiciones";default:return""}},ie=(e,a)=>{G(r=>(0,t.A)((0,t.A)({},r),{},{[e]:a}));const r=ne(e,a);se(a=>(0,t.A)((0,t.A)({},a),{},{[e]:r}))},le=async()=>{(()=>{let e=!0;const a={};switch(r){case 0:break;case 1:F.role||(a.role="Selecciona un tipo de cuenta",e=!1);break;case 2:0===H?["fullName","email","password","confirmPassword"].forEach(r=>{const t=ne(r,F[r]);t&&(a[r]=t,e=!1)}):1===H&&["fullName","phone"].forEach(r=>{const t=ne(r,F[r]);t&&(a[r]=t,e=!1)}),"worker"!==F.role||F.trade||(a.trade="Selecciona tu oficio principal",e=!1),"employer"!==F.role||F.companyName||(a.companyName="El nombre de la empresa es requerido",e=!1),F.acceptTerms||(a.acceptTerms="Debes aceptar los t\xe9rminos y condiciones",e=!1)}return se(a),e})()?r===q.length-2?0===H?await ce():1===H&&await de():O(e=>e+1):ae("Por favor completa todos los campos requeridos")},ce=async()=>{try{ae(""),te(!0);const a=await(0,M.eJ)(z.j2,F.email,F.password);await(0,M.r7)(a.user,{displayName:F.fullName}),await pe(a.user.uid,{email:F.email,displayName:F.fullName}),O(e=>e+1),setTimeout(()=>{e("/onboarding")},2e3)}catch(ee){"auth/email-already-in-use"===ee.code?ae("Este email ya est\xe1 registrado. Por favor inicia sesi\xf3n."):"auth/weak-password"===ee.code?ae("La contrase\xf1a es muy d\xe9bil."):ae(ee.message)}finally{te(!1)}},de=async()=>{try{ae(""),te(!0);let e=F.phone;if(e.startsWith("+")||(e="+52"+e.replace(/\D/g,"")),!Z)throw new Error("reCAPTCHA no est\xe1 configurado");const a=await(0,z.zN)(e,Z);Y(a),O(e=>e+1)}catch(ee){"auth/invalid-phone-number"===ee.code?ae("N\xfamero de tel\xe9fono inv\xe1lido"):ae(ee.message);const a=(0,z.zE)("register-recaptcha-container");$(a)}finally{te(!1)}},pe=async(e,a)=>{const r={id:e,email:a.email||F.email||"",phone:a.phone||F.phone||"",displayName:a.displayName||F.fullName||"",photoURL:a.photoURL||"",role:F.role,createdAt:new Date,updatedAt:new Date};await(0,L.BN)((0,L.H9)(z.db,"users",e),r),"worker"===F.role?await(0,L.BN)((0,L.H9)(z.db,"workers",e),{userId:e,name:F.fullName,phone:F.phone,trade:F.trade||"",experience:F.experience||0,location:F.location,certifications:[],rating:0,totalRatings:0,available:!0,createdAt:new Date,updatedAt:new Date}):await(0,L.BN)((0,L.H9)(z.db,"employers",e),{userId:e,companyName:F.companyName||"",contactName:F.fullName,phone:F.phone,businessType:F.businessType||"",location:F.location,rating:0,totalRatings:0,createdAt:new Date,updatedAt:new Date})};return(0,_.jsxs)(n.A,{maxWidth:"md",children:[(0,_.jsx)(i.A,{sx:{mt:4,mb:4},children:(0,_.jsxs)(l.A,{elevation:3,sx:{p:4},children:[(0,_.jsx)(c.A,{variant:"h4",align:"center",gutterBottom:!0,fontWeight:"bold",children:"\xdanete a DOOM"}),(0,_.jsx)(c.A,{variant:"body1",align:"center",color:"text.secondary",sx:{mb:3},children:"Conecta con oportunidades para el Mundial 2026"}),(0,_.jsx)(d.A,{activeStep:r,sx:{mb:4},children:q.map(e=>(0,_.jsx)(p.A,{children:(0,_.jsx)(m.A,{children:e})},e))}),ee&&(0,_.jsx)(h.A,{severity:"error",sx:{mb:2},onClose:()=>ae(""),children:ee}),0===r&&(0,_.jsxs)(i.A,{children:[(0,_.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"\xbfC\xf3mo quieres registrarte?"}),(0,_.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2,mt:3},children:[(0,_.jsx)(l.A,{elevation:0===H?4:1,sx:{p:3,cursor:"pointer",border:0===H?"2px solid":"2px solid transparent",borderColor:0===H?"primary.main":"transparent",transition:"all 0.3s ease","&:hover":{elevation:3,borderColor:"primary.light"}},onClick:()=>U(0),children:(0,_.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,_.jsx)(E.A,{color:0===H?"primary":"action"}),(0,_.jsxs)(i.A,{children:[(0,_.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"Correo electr\xf3nico"}),(0,_.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Reg\xedstrate con tu email y contrase\xf1a"})]})]})}),(0,_.jsx)(l.A,{elevation:1===H?4:1,sx:{p:3,cursor:"pointer",border:1===H?"2px solid":"2px solid transparent",borderColor:1===H?"primary.main":"transparent",transition:"all 0.3s ease","&:hover":{elevation:3,borderColor:"primary.light"}},onClick:()=>U(1),children:(0,_.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,_.jsx)(I.A,{color:1===H?"primary":"action"}),(0,_.jsxs)(i.A,{children:[(0,_.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"N\xfamero de tel\xe9fono"}),(0,_.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Recibe un c\xf3digo SMS para verificar"})]})]})}),(0,_.jsx)(l.A,{elevation:2===H?4:1,sx:{p:3,cursor:"pointer",border:2===H?"2px solid":"2px solid transparent",borderColor:2===H?"#4285f4":"transparent",transition:"all 0.3s ease","&:hover":{elevation:3,borderColor:"#357ae8"}},onClick:()=>{U(2),(async()=>{try{ae(""),te(!0);const a=await(0,z.G6)();await pe(a.user.uid,{email:a.user.email||"",displayName:a.user.displayName||"",photoURL:a.user.photoURL||""}),e("/onboarding")}catch(ee){ae(ee.message)}finally{te(!1)}})()},children:(0,_.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:2},children:[(0,_.jsx)(S.A,{sx:{color:2===H?"#4285f4":"action"}}),(0,_.jsxs)(i.A,{children:[(0,_.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"Google"}),(0,_.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Contin\xfaa con tu cuenta de Google"})]})]})})]})]}),1===r&&(0,_.jsxs)(i.A,{children:[(0,_.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"\xbfQu\xe9 tipo de cuenta necesitas?"}),(0,_.jsx)(x.A,{component:"fieldset",sx:{mt:3,width:"100%"},children:(0,_.jsxs)(u.A,{value:F.role,onChange:e=>ie("role",e.target.value),children:[(0,_.jsx)(l.A,{sx:{mb:2,p:2},children:(0,_.jsx)(A.A,{value:"worker",control:(0,_.jsx)(j.A,{}),label:(0,_.jsxs)(i.A,{children:[(0,_.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,_.jsx)(D.A,{color:"primary"}),(0,_.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"Trabajador"})]}),(0,_.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Busco oportunidades de empleo para el Mundial 2026"})]})})}),(0,_.jsx)(l.A,{sx:{p:2},children:(0,_.jsx)(A.A,{value:"employer",control:(0,_.jsx)(j.A,{}),label:(0,_.jsxs)(i.A,{children:[(0,_.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,_.jsx)(k.A,{color:"secondary"}),(0,_.jsx)(c.A,{variant:"subtitle1",fontWeight:"bold",children:"Empleador"})]}),(0,_.jsx)(c.A,{variant:"body2",color:"text.secondary",children:"Busco contratar trabajadores calificados"})]})})})]})})]}),2===r&&(0,_.jsxs)(i.A,{children:[(0,_.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Informaci\xf3n personal"}),(0,_.jsxs)(i.A,{sx:{mt:3},children:[(0,_.jsx)(g.A,{fullWidth:!0,label:"Nombre completo",value:F.fullName,onChange:e=>ie("fullName",e.target.value),error:!!oe.fullName,helperText:oe.fullName,sx:{mb:2}}),0===H&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(g.A,{fullWidth:!0,type:"email",label:"Correo electr\xf3nico",value:F.email,onChange:e=>ie("email",e.target.value),error:!!oe.email,helperText:oe.email,sx:{mb:2}}),(0,_.jsx)(g.A,{fullWidth:!0,type:K?"text":"password",label:"Contrase\xf1a",value:F.password,onChange:e=>ie("password",e.target.value),error:!!oe.password,helperText:oe.password||"M\xednimo 6 caracteres",InputProps:{endAdornment:(0,_.jsx)(b.A,{position:"end",children:(0,_.jsx)(y.A,{onClick:()=>X(!K),edge:"end",children:K?(0,_.jsx)(P.A,{}):(0,_.jsx)(B.A,{})})})},sx:{mb:2}}),(0,_.jsx)(g.A,{fullWidth:!0,type:K?"text":"password",label:"Confirmar contrase\xf1a",value:F.confirmPassword,onChange:e=>ie("confirmPassword",e.target.value),error:!!oe.confirmPassword,helperText:oe.confirmPassword,sx:{mb:2}})]}),1===H&&(0,_.jsx)(g.A,{fullWidth:!0,label:"N\xfamero de tel\xe9fono",placeholder:"5512345678",value:F.phone,onChange:e=>ie("phone",e.target.value),error:!!oe.phone,helperText:oe.phone||"N\xfamero de 10 d\xedgitos",InputProps:{startAdornment:(0,_.jsx)(b.A,{position:"start",children:(0,_.jsx)(c.A,{color:"text.secondary",children:"+52"})})},sx:{mb:2}}),"worker"===F.role&&(0,_.jsx)(g.A,{fullWidth:!0,label:"Oficio principal",placeholder:"Ej: Mesero, Electricista, Traductor",value:F.trade,onChange:e=>ie("trade",e.target.value),error:!!oe.trade,helperText:oe.trade,sx:{mb:2}}),"employer"===F.role&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(g.A,{fullWidth:!0,label:"Nombre de la empresa",value:F.companyName,onChange:e=>ie("companyName",e.target.value),error:!!oe.companyName,helperText:oe.companyName,sx:{mb:2}}),(0,_.jsx)(g.A,{fullWidth:!0,label:"Tipo de negocio",placeholder:"Ej: Restaurante, Construcci\xf3n, Hotel",value:F.businessType,onChange:e=>ie("businessType",e.target.value),sx:{mb:2}})]}),(0,_.jsx)(g.A,{fullWidth:!0,label:"Ubicaci\xf3n",value:F.location,onChange:e=>ie("location",e.target.value),sx:{mb:3}}),(0,_.jsx)(A.A,{control:(0,_.jsx)(f.A,{checked:F.acceptTerms,onChange:e=>ie("acceptTerms",e.target.checked),color:"primary"}),label:(0,_.jsxs)(c.A,{variant:"body2",children:["Acepto los"," ",(0,_.jsx)(s.N_,{to:"/terms",target:"_blank",children:"t\xe9rminos y condiciones"})," ","y la"," ",(0,_.jsx)(s.N_,{to:"/privacy",target:"_blank",children:"pol\xedtica de privacidad"})]})}),oe.acceptTerms&&(0,_.jsx)(v.A,{error:!0,children:oe.acceptTerms})]})]}),3===r&&(0,_.jsx)(i.A,{sx:{textAlign:"center",py:4},children:1!==H||Q?1===H?(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(c.A,{variant:"h6",gutterBottom:!0,children:"Verifica tu n\xfamero"}),(0,_.jsxs)(c.A,{variant:"body1",color:"text.secondary",sx:{mb:3},children:["Enviamos un c\xf3digo de 6 d\xedgitos a +52",F.phone]}),(0,_.jsx)(g.A,{label:"C\xf3digo de verificaci\xf3n",placeholder:"123456",value:V,onChange:e=>J(e.target.value),disabled:re,sx:{mb:3,minWidth:200}}),(0,_.jsx)(i.A,{children:(0,_.jsx)(N.A,{variant:"contained",size:"large",onClick:async()=>{try{if(ae(""),te(!0),!Q)throw new Error("No hay verificaci\xf3n pendiente");const a=await Q.confirm(V);await(0,M.r7)(a.user,{displayName:F.fullName}),await pe(a.user.uid,{phone:F.phone,displayName:F.fullName}),e("/onboarding")}catch(ee){"auth/invalid-verification-code"===ee.code?ae("C\xf3digo de verificaci\xf3n incorrecto"):ae(ee.message)}finally{te(!1)}},disabled:re||V.length<6,children:re?(0,_.jsx)(w.A,{size:24}):"Verificar"})})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(W.A,{sx:{fontSize:80,color:"success.main",mb:2}}),(0,_.jsx)(c.A,{variant:"h5",gutterBottom:!0,fontWeight:"bold",children:"\xa1Registro exitoso!"}),(0,_.jsx)(c.A,{variant:"body1",color:"text.secondary",children:"Bienvenido a DOOM. Redirigiendo..."}),(0,_.jsx)(w.A,{sx:{mt:3}})]}):(0,_.jsx)(w.A,{size:60})}),r<3&&(0,_.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mt:4},children:[(0,_.jsx)(N.A,{onClick:()=>{O(e=>e-1),ae("")},disabled:0===r||re,startIcon:(0,_.jsx)(T.A,{}),children:"Atr\xe1s"}),r<2?(0,_.jsx)(N.A,{variant:"contained",onClick:le,disabled:re||0===r&&2===H,children:"Siguiente"}):(0,_.jsx)(N.A,{variant:"contained",onClick:le,disabled:re||!F.acceptTerms,children:re?(0,_.jsx)(w.A,{size:24}):"Registrarme"})]}),(0,_.jsx)(C.A,{sx:{my:3}}),(0,_.jsx)(i.A,{sx:{textAlign:"center"},children:(0,_.jsxs)(c.A,{variant:"body2",children:["\xbfYa tienes cuenta?"," ",(0,_.jsx)(s.N_,{to:"/login",style:{textDecoration:"none"},children:(0,_.jsx)(c.A,{component:"span",color:"primary",fontWeight:"bold",children:"Inicia sesi\xf3n aqu\xed"})})]})})]})}),(0,_.jsx)("div",{id:"register-recaptcha-container"})]})}}}]);
//# sourceMappingURL=169.337f4e5e.chunk.js.map