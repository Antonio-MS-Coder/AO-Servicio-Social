"use strict";(self.webpackChunkdoom_mvp=self.webpackChunkdoom_mvp||[]).push([[743],{1387:(e,r,a)=>{a.d(r,{A:()=>o});var t=a(6734),l=a(579);const o=(0,t.A)((0,l.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},1743:(e,r,a)=>{a.r(r),a.d(r,{default:()=>O});var t=a(9379),l=a(5043),o=a(4117),i=a(9981),n=a(9252),s=a(1637),c=a(5865),d=a(7254),u=a(3336),p=a(1045),h=a(1906),x=a(7784),A=a(2143),v=a(4605),m=a(4598),f=a(6446),g=a(5721),j=a(5537),b=a(8734),y=a(3845),w=a(8266),C=a(7392),E=a(8903),k=a(2429),R=a(6734),N=a(579);const I=(0,R.A)((0,N.jsx)("path",{d:"M5 20h14v-2H5zm0-10h4v6h6v-6h4l-7-7z"}),"Upload");var T=a(8606),D=a(1387),z=a(7141),H=a(6667),U=a(6068),W=a(8836),S=a(9066),M=a(6892);const O=()=>{var e;const{t:r}=(0,o.Bd)(),a=(0,i.Zp)(),{currentUser:R,userData:O}=(0,S.A)(),[V,F]=(0,l.useState)(!0),[L,P]=(0,l.useState)(!1),[B,G]=(0,l.useState)(null),[K,q]=(0,l.useState)({name:"",trade:M.h.OTHER,experience:0,location:"",bio:"",available:!0,certifications:[]}),[Z,_]=(0,l.useState)({companyName:"",contactName:"",businessType:"",location:"",description:""});(0,l.useEffect)(()=>{"worker"!==(null===O||void 0===O?void 0:O.role)?R&&Y():a("/worker-profile-edit")},[R,O,a]);const Y=async()=>{try{const e="worker"===(null===O||void 0===O?void 0:O.role)?"workers":"employers",r=await(0,H.x7)((0,H.H9)(W.db,e,R.uid));if(r.exists()){const e=r.data();"worker"===(null===O||void 0===O?void 0:O.role)?q(e):_(e)}}catch(e){console.error("Error fetching profile:",e),G({type:"error",text:"Error al cargar el perfil"})}finally{F(!1)}};return V?(0,N.jsx)(n.A,{maxWidth:"md",sx:{py:4,textAlign:"center"},children:(0,N.jsx)(s.A,{})}):(0,N.jsxs)(n.A,{maxWidth:"md",sx:{py:4},children:[(0,N.jsx)(c.A,{variant:"h4",gutterBottom:!0,children:r("nav.profile")}),B&&(0,N.jsx)(d.A,{severity:B.type,sx:{mb:2},onClose:()=>G(null),children:B.text}),(0,N.jsx)(u.A,{sx:{p:3,mb:3},children:(0,N.jsxs)(E.Ay,{container:!0,spacing:3,children:[(0,N.jsxs)(E.Ay,{item:!0,xs:12,md:4,sx:{textAlign:"center"},children:[(0,N.jsx)(p.A,{src:"worker"===(null===O||void 0===O?void 0:O.role)?K.photoUrl:Z.logoUrl,sx:{width:150,height:150,mx:"auto",mb:2}}),(0,N.jsx)("input",{accept:"image/*",type:"file",id:"photo-upload",hidden:!0,onChange:async e=>{if(e.target.files&&e.target.files[0]){const a=e.target.files[0],l=(0,U.KR)(W.IG,"profile-photos/".concat(R.uid));try{P(!0);const e=await(0,U.D)(l,a),r=await(0,U.qk)(e.ref);"worker"===(null===O||void 0===O?void 0:O.role)?q((0,t.A)((0,t.A)({},K),{},{photoUrl:r})):_((0,t.A)((0,t.A)({},Z),{},{logoUrl:r})),G({type:"success",text:"Foto actualizada"})}catch(r){console.error("Error uploading photo:",r),G({type:"error",text:"Error al subir la foto"})}finally{P(!1)}}}}),(0,N.jsx)("label",{htmlFor:"photo-upload",children:(0,N.jsx)(h.A,{variant:"outlined",component:"span",startIcon:(0,N.jsx)(k.A,{}),disabled:L,children:r("profile.uploadPhoto")})})]}),(0,N.jsxs)(E.Ay,{item:!0,xs:12,md:8,children:["worker"===(null===O||void 0===O?void 0:O.role)?(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(x.A,{fullWidth:!0,label:r("profile.name"),value:K.name,onChange:e=>q((0,t.A)((0,t.A)({},K),{},{name:e.target.value})),sx:{mb:2}}),(0,N.jsx)(x.A,{fullWidth:!0,select:!0,label:r("profile.trade"),value:K.trade,onChange:e=>q((0,t.A)((0,t.A)({},K),{},{trade:e.target.value})),sx:{mb:2},children:Object.values(M.h).map(e=>(0,N.jsx)(A.A,{value:e,children:r("trades.".concat(e))},e))}),(0,N.jsx)(x.A,{fullWidth:!0,type:"number",label:r("profile.experience"),value:K.experience,onChange:e=>q((0,t.A)((0,t.A)({},K),{},{experience:parseInt(e.target.value)})),sx:{mb:2}}),(0,N.jsx)(v.A,{control:(0,N.jsx)(m.A,{checked:K.available,onChange:e=>q((0,t.A)((0,t.A)({},K),{},{available:e.target.checked}))}),label:K.available?r("profile.available"):r("profile.notAvailable"),sx:{mb:2}})]}):(0,N.jsxs)(N.Fragment,{children:[(0,N.jsx)(x.A,{fullWidth:!0,label:"Nombre de la Empresa",value:Z.companyName,onChange:e=>_((0,t.A)((0,t.A)({},Z),{},{companyName:e.target.value})),sx:{mb:2}}),(0,N.jsx)(x.A,{fullWidth:!0,label:"Nombre del Contacto",value:Z.contactName,onChange:e=>_((0,t.A)((0,t.A)({},Z),{},{contactName:e.target.value})),sx:{mb:2}}),(0,N.jsx)(x.A,{fullWidth:!0,label:"Tipo de Negocio",value:Z.businessType,onChange:e=>_((0,t.A)((0,t.A)({},Z),{},{businessType:e.target.value})),sx:{mb:2}})]}),(0,N.jsx)(x.A,{fullWidth:!0,label:r("profile.location"),value:"worker"===(null===O||void 0===O?void 0:O.role)?K.location:Z.location,onChange:e=>{"worker"===(null===O||void 0===O?void 0:O.role)?q((0,t.A)((0,t.A)({},K),{},{location:e.target.value})):_((0,t.A)((0,t.A)({},Z),{},{location:e.target.value}))},sx:{mb:2}}),(0,N.jsx)(x.A,{fullWidth:!0,multiline:!0,rows:4,label:r("profile.bio"),value:"worker"===(null===O||void 0===O?void 0:O.role)?K.bio:Z.description,onChange:e=>{"worker"===(null===O||void 0===O?void 0:O.role)?q((0,t.A)((0,t.A)({},K),{},{bio:e.target.value})):_((0,t.A)((0,t.A)({},Z),{},{description:e.target.value}))}})]})]})}),"worker"===(null===O||void 0===O?void 0:O.role)&&(0,N.jsxs)(u.A,{sx:{p:3,mb:3},children:[(0,N.jsxs)(f.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,N.jsx)(c.A,{variant:"h6",children:r("profile.certifications")}),(0,N.jsx)("input",{accept:".pdf,.jpg,.jpeg,.png",type:"file",id:"cert-upload",hidden:!0,onChange:async e=>{if(e.target.files&&e.target.files[0]&&"worker"===(null===O||void 0===O?void 0:O.role)){const a=e.target.files[0],l=Date.now().toString(),o=(0,U.KR)(W.IG,"certifications/".concat(R.uid,"/").concat(l));try{P(!0);const e=await(0,U.D)(o,a),r=await(0,U.qk)(e.ref),i={id:l,name:a.name,issuer:"",issueDate:new Date,fileUrl:r,verified:!1},n=[...K.certifications||[],i];q((0,t.A)((0,t.A)({},K),{},{certifications:n})),G({type:"success",text:"Certificaci\xf3n agregada"})}catch(r){console.error("Error uploading certification:",r),G({type:"error",text:"Error al subir la certificaci\xf3n"})}finally{P(!1)}}}}),(0,N.jsx)("label",{htmlFor:"cert-upload",children:(0,N.jsx)(h.A,{variant:"outlined",component:"span",startIcon:(0,N.jsx)(I,{}),disabled:L,children:r("profile.uploadCertification")})})]}),(0,N.jsx)(g.A,{children:null===(e=K.certifications)||void 0===e?void 0:e.map(e=>(0,N.jsxs)(j.Ay,{children:[(0,N.jsx)(b.A,{primary:e.name,secondary:e.issuer||"Sin emisor"}),e.verified&&(0,N.jsx)(y.A,{icon:(0,N.jsx)(T.A,{}),label:"Verificado",color:"success",size:"small",sx:{mr:2}}),(0,N.jsx)(w.A,{children:(0,N.jsx)(C.A,{edge:"end","aria-label":"delete",children:(0,N.jsx)(D.A,{})})})]},e.id))})]}),(0,N.jsx)(f.A,{sx:{display:"flex",justifyContent:"flex-end"},children:(0,N.jsx)(h.A,{variant:"contained",size:"large",startIcon:(0,N.jsx)(z.A,{}),onClick:async()=>{try{P(!0);const e="worker"===(null===O||void 0===O?void 0:O.role)?"workers":"employers",a="worker"===(null===O||void 0===O?void 0:O.role)?K:Z;await(0,H.mZ)((0,H.H9)(W.db,e,R.uid),(0,t.A)((0,t.A)({},a),{},{updatedAt:new Date})),G({type:"success",text:r("messages.profileUpdated")})}catch(e){console.error("Error saving profile:",e),G({type:"error",text:"Error al guardar el perfil"})}finally{P(!1)}},disabled:L,children:L?(0,N.jsx)(s.A,{size:24}):r("actions.save")})})]})}},2429:(e,r,a)=>{a.d(r,{A:()=>o});var t=a(6734),l=a(579);const o=(0,t.A)([(0,l.jsx)("circle",{cx:"12",cy:"12",r:"3.2"},"0"),(0,l.jsx)("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"PhotoCamera")},6892:(e,r,a)=>{a.d(r,{h:()=>t});let t=function(e){return e.WAITER="waiter",e.COOK="cook",e.BARTENDER="bartender",e.CLEANER="cleaner",e.SECURITY="security",e.DRIVER="driver",e.TRANSLATOR="translator",e.GUIDE="guide",e.ELECTRICIAN="electrician",e.PLUMBER="plumber",e.CARPENTER="carpenter",e.PAINTER="painter",e.GARDENER="gardener",e.TECHNICIAN="technician",e.OTHER="other",e}({})},7141:(e,r,a)=>{a.d(r,{A:()=>o});var t=a(6734),l=a(579);const o=(0,t.A)((0,l.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")}}]);
//# sourceMappingURL=743.fc17eccc.chunk.js.map